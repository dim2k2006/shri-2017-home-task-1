"use strict";window.addEventListener("load",function(){window.app.modules.main.init(),objectFitImages()}),function(){if(window.app||(window.app={}),"modules"in window.app||(window.app.modules={}),!("gallery"in app.modules)){var e=function(){var e=this;e.getOptions=function(){e.container=document.querySelector(".gallery"),e.modalOpen=app.modules.modal.open},e.setupListener=function(){e.container.addEventListener("click",e.handleClick)},e.handleClick=function(n){var t=n.target,o=t.closest(".gallery__link");if(n.preventDefault(),o){var i=JSON.parse(o.getAttribute("data-info"));e.modalOpen(i)}},e.init=function(){e.getOptions(),e.setupListener()}};window.app.modules.gallery=new e}}(),function(){if(window.app||(window.app={}),"modules"in window.app||(window.app.modules={}),!("main"in app.modules)){var e=function(){var e=this;e.getOptions=function(){e.html=document.querySelector("html"),e.body=document.querySelector("body"),e.modules=app.modules},e.initModules=function(){for(var n in e.modules)e.modules.hasOwnProperty(n)&&"undefined"!=typeof e.modules[n].init&&"main"!==n&&e.modules[n].init()},e.init=function(){e.getOptions(),e.initModules()}};window.app.modules.main=new e}}(),function(){if(window.app||(window.app={}),"modules"in window.app||(window.app.modules={}),!("modal"in app.modules)){var e=function(){var e=this;e.getOptions=function(){e.container=document.querySelector(".modal"),e.title=document.querySelector(".modal__title"),e.description=document.querySelector(".modal__description p"),e.img=document.querySelector(".modal__preview img"),e.closeBtn=document.querySelector(".modal__close")},e.setupListener=function(){e.closeBtn.addEventListener("click",e.close)},e.open=function(n){var t=n||{};t.title=t.title?t.title:"Заголовок изображения не найден",t.description=t.description?t.description:"Описание изображения не найдено.",t.source=t.source?t.source:"images/vis-error.jpg",e.title.textContent=t.title,e.description.textContent=t.description,e.img.src=t.source,e.container.classList.add("modal_state_open"),e.container.classList.add("modal_state_loading"),e.img.addEventListener("load",e.load)},e.close=function(){e.container.classList.remove("modal_state_open"),e.container.classList.remove("modal_state_loading"),e.img.removeEventListener("load",e.load)},e.load=function(){e.container.classList.remove("modal_state_loading")},e.init=function(){e.getOptions(),e.setupListener()}};window.app.modules.modal=new e}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4ubWluLmpzIiwibWFpbi5qcyIsImdhbGxlcnkvZ2FsbGVyeS5qcyIsIm1haW4vbWFpbi5qcyIsIm1vZGFsL21vZGFsLmpzIl0sIm5hbWVzIjpbIndpbmRvdyIsImFkZEV2ZW50TGlzdGVuZXIiLCJhcHAiLCJtb2R1bGVzIiwibWFpbiIsImluaXQiLCJvYmplY3RGaXRJbWFnZXMiLCJHYWxsZXJ5Iiwic2VsZiIsInRoaXMiLCJnZXRPcHRpb25zIiwiY29udGFpbmVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibW9kYWxPcGVuIiwibW9kYWwiLCJvcGVuIiwic2V0dXBMaXN0ZW5lciIsImhhbmRsZUNsaWNrIiwiZXZlbnQiLCJ0YXJnZXQiLCJsaW5rIiwiY2xvc2VzdCIsInByZXZlbnREZWZhdWx0IiwiaW5mbyIsIkpTT04iLCJwYXJzZSIsImdldEF0dHJpYnV0ZSIsImdhbGxlcnkiLCJNYWluIiwiaHRtbCIsImJvZHkiLCJpbml0TW9kdWxlcyIsIm1vZHVsZSIsImhhc093blByb3BlcnR5IiwiTW9kYWwiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiaW1nIiwiY2xvc2VCdG4iLCJjbG9zZSIsImRhdGEiLCJzb3VyY2UiLCJ0ZXh0Q29udGVudCIsInNyYyIsImNsYXNzTGlzdCIsImFkZCIsImxvYWQiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoiQUFBQSxZQ0dBQSxRQUFBQyxpQkFBQSxPQUFBLFdBQ0FELE9BQUFFLElBQUFDLFFBQUFDLEtBQUFDLE9BRUFDLG9CQ05BLFdBU0EsR0FSQU4sT0FBQUUsTUFDQUYsT0FBQUUsUUFHQSxXQUFBRixRQUFBRSxNQUNBRixPQUFBRSxJQUFBQyxjQUdBLFdBQUFELEtBQUFDLFNBQUEsQ0FRQSxHQUFBSSxHQUFBLFdBQ0EsR0FBQUMsR0FBQUMsSUFLQUQsR0FBQUUsV0FBQSxXQUNBRixFQUFBRyxVQUFBQyxTQUFBQyxjQUFBLFlBQ0FMLEVBQUFNLFVBQUFaLElBQUFDLFFB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ICogSW5pdCBtYWluIG1vZHVsZVxuICovXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICB3aW5kb3cuYXBwLm1vZHVsZXMubWFpbi5pbml0KCk7XG5cbiAgICBvYmplY3RGaXRJbWFnZXMoKTtcbn0pO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgIGlmICghd2luZG93LmFwcCkge1xuICAgICAgICB3aW5kb3cuYXBwID0ge307XG4gICAgfVxuXG4gICAgaWYgKCEoJ21vZHVsZXMnIGluIHdpbmRvdy5hcHApKSB7XG4gICAgICAgIHdpbmRvdy5hcHAubW9kdWxlcyA9IHt9O1xuICAgIH1cblxuICAgIGlmICgnZ2FsbGVyeScgaW4gYXBwLm1vZHVsZXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgR2FsbGVyeSBjbGFzcy5cbiAgICAgKiBAY2xhc3NcbiAgICAgKi9cbiAgICB2YXIgR2FsbGVyeSA9IGZ1bmN0aW9uIEdhbGxlcnkoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcblxuICAgICAgICAvKipcbiAgICAgICAgICogR2V0IG9wdGlvbnMgZm9yIG1vZHVsZVxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5nZXRPcHRpb25zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZ2FsbGVyeScpO1xuICAgICAgICAgICAgc2VsZi5tb2RhbE9wZW4gPSBhcHAubW9kdWxlcy5tb2RhbC5vcGVuO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgZXZlbnRzIGxpc3RlbmVyc1xuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5zZXR1cExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZWxmLmhhbmRsZUNsaWNrKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSGFuZGxlIGNsaWNrIGV2ZW50XG4gICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBldmVudFxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgICAgIHZhciBsaW5rID0gdGFyZ2V0LmNsb3Nlc3QoJy5nYWxsZXJ5X19saW5rJyk7XG5cbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgIGlmICghbGluaykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGluZm8gPSBKU09OLnBhcnNlKGxpbmsuZ2V0QXR0cmlidXRlKCdkYXRhLWluZm8nKSk7XG5cbiAgICAgICAgICAgIHNlbGYubW9kYWxPcGVuKGluZm8pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0IG1vZHVsZVxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5nZXRPcHRpb25zKCk7XG4gICAgICAgICAgICBzZWxmLnNldHVwTGlzdGVuZXIoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgd2luZG93LmFwcC5tb2R1bGVzLmdhbGxlcnkgPSBuZXcgR2FsbGVyeSgpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXdpbmRvdy5hcHApIHtcbiAgICAgICAgd2luZG93LmFwcCA9IHt9O1xuICAgIH1cblxuICAgIGlmICghKCdtb2R1bGVzJyBpbiB3aW5kb3cuYXBwKSkge1xuICAgICAgICB3aW5kb3cuYXBwLm1vZHVsZXMgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAoJ21haW4nIGluIGFwcC5tb2R1bGVzKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IE1haW4gY2xhc3MuXG4gICAgICogQGNsYXNzXG4gICAgICovXG4gICAgdmFyIE1haW4gPSBmdW5jdGlvbiBNYWluKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBvcHRpb25zIGZvciBtb2R1bGVcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuZ2V0T3B0aW9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYuaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTtcbiAgICAgICAgICAgIHNlbGYuYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcbiAgICAgICAgICAgIHNlbGYubW9kdWxlcyA9IGFwcC5tb2R1bGVzO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0IGFsbCBtb2R1bGVzIGluIGFwcC5tb2R1bGVzXG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLmluaXRNb2R1bGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgbW9kdWxlIGluIHNlbGYubW9kdWxlcykge1xuXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYubW9kdWxlcy5oYXNPd25Qcm9wZXJ0eShtb2R1bGUpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLm1vZHVsZXNbbW9kdWxlXS5pbml0ICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUgIT09ICdtYWluJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZHVsZXNbbW9kdWxlXS5pbml0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXQgbW9kdWxlXG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLmdldE9wdGlvbnMoKTtcbiAgICAgICAgICAgIHNlbGYuaW5pdE1vZHVsZXMoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgd2luZG93LmFwcC5tb2R1bGVzLm1haW4gPSBuZXcgTWFpbigpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIXdpbmRvdy5hcHApIHtcbiAgICAgICAgd2luZG93LmFwcCA9IHt9O1xuICAgIH1cblxuICAgIGlmICghKCdtb2R1bGVzJyBpbiB3aW5kb3cuYXBwKSkge1xuICAgICAgICB3aW5kb3cuYXBwLm1vZHVsZXMgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAoJ21vZGFsJyBpbiBhcHAubW9kdWxlcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBNb2RhbCBjbGFzcy5cbiAgICAgKiBAY2xhc3NcbiAgICAgKi9cbiAgICB2YXIgTW9kYWwgPSBmdW5jdGlvbiBNb2RhbCgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBHZXQgb3B0aW9ucyBmb3IgbW9kdWxlXG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLmdldE9wdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLmNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbCcpO1xuICAgICAgICAgICAgc2VsZi50aXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fdGl0bGUnKTtcbiAgICAgICAgICAgIHNlbGYuZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Rlc2NyaXB0aW9uIHAnKTtcbiAgICAgICAgICAgIHNlbGYuaW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19wcmV2aWV3IGltZycpO1xuICAgICAgICAgICAgc2VsZi5jbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGV2ZW50cyBsaXN0ZW5lcnNcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuc2V0dXBMaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYuY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZWxmLmNsb3NlKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogT3BlbiBtb2RhbCB3aW5kb3dcbiAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IGluZm9cbiAgICAgICAgICovXG4gICAgICAgIHNlbGYub3BlbiA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IGluZm8gfHwge307XG5cbiAgICAgICAgICAgIGRhdGEudGl0bGUgPSBkYXRhLnRpdGxlID8gZGF0YS50aXRsZSA6ICfQl9Cw0LPQvtC70L7QstC+0Log0LjQt9C+0LHRgNCw0LbQtdC90LjRjyDQvdC1INC90LDQudC00LXQvSc7XG4gICAgICAgICAgICBkYXRhLmRlc2NyaXB0aW9uID0gZGF0YS5kZXNjcmlwdGlvbiA/IGRhdGEuZGVzY3JpcHRpb24gOiAn0J7Qv9C40YHQsNC90LjQtSDQuNC30L7QsdGA0LDQttC10L3QuNGPINC90LUg0L3QsNC50LTQtdC90L4uJztcbiAgICAgICAgICAgIGRhdGEuc291cmNlID0gZGF0YS5zb3VyY2UgPyBkYXRhLnNvdXJjZSA6ICdpbWFnZXMvdmlzLWVycm9yLmpwZyc7XG5cbiAgICAgICAgICAgIHNlbGYudGl0bGUudGV4dENvbnRlbnQgPSBkYXRhLnRpdGxlO1xuICAgICAgICAgICAgc2VsZi5kZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuZGVzY3JpcHRpb247XG4gICAgICAgICAgICBzZWxmLmltZy5zcmMgPSBkYXRhLnNvdXJjZTtcblxuICAgICAgICAgICAgc2VsZi5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgnbW9kYWxfc3RhdGVfb3BlbicpO1xuICAgICAgICAgICAgc2VsZi5jb250YWluZXIuY2xhc3NMaXN0LmFkZCgnbW9kYWxfc3RhdGVfbG9hZGluZycpO1xuXG4gICAgICAgICAgICBzZWxmLmltZy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgc2VsZi5sb2FkKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQ2xvc2UgbW9kYWwgd2luZG93XG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi5jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWxfc3RhdGVfb3BlbicpO1xuICAgICAgICAgICAgc2VsZi5jb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnbW9kYWxfc3RhdGVfbG9hZGluZycpO1xuXG4gICAgICAgICAgICBzZWxmLmltZy5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkJywgc2VsZi5sb2FkKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogUmVtb3ZlIGxvYWRpbmcgc3RhdGVcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX3N0YXRlX2xvYWRpbmcnKTtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogSW5pdCBtb2R1bGVcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYuZ2V0T3B0aW9ucygpO1xuICAgICAgICAgICAgc2VsZi5zZXR1cExpc3RlbmVyKCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIHdpbmRvdy5hcHAubW9kdWxlcy5tb2RhbCA9IG5ldyBNb2RhbCgpO1xufSkoKTsiLCIvKipcbiAqIEluaXQgbWFpbiBtb2R1bGVcbiAqL1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgd2luZG93LmFwcC5tb2R1bGVzLm1haW4uaW5pdCgpO1xuXG4gICAgb2JqZWN0Rml0SW1hZ2VzKCk7XG59KTtcbiIsIigoKSA9PiB7XG4gICAgaWYgKCF3aW5kb3cuYXBwKSB7XG4gICAgICAgIHdpbmRvdy5hcHAgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAoISgnbW9kdWxlcycgaW4gd2luZG93LmFwcCkpIHtcbiAgICAgICAgd2luZG93LmFwcC5tb2R1bGVzID0ge307XG4gICAgfVxuXG4gICAgaWYgKCdnYWxsZXJ5JyBpbiBhcHAubW9kdWxlcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBHYWxsZXJ5IGNsYXNzLlxuICAgICAqIEBjbGFzc1xuICAgICAqL1xuICAgIGNvbnN0IEdhbGxlcnkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBvcHRpb25zIGZvciBtb2R1bGVcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuZ2V0T3B0aW9ucyA9ICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdhbGxlcnknKTtcbiAgICAgICAgICAgIHNlbGYubW9kYWxPcGVuID0gYXBwLm1vZHVsZXMubW9kYWwub3BlbjtcbiAgICAgICAgfTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogQWRkIGV2ZW50cyBsaXN0ZW5lcnNcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuc2V0dXBMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2VsZi5oYW5kbGVDbGljayk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhbmRsZSBjbGljayBldmVudFxuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnRcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICAgICAgY29uc3QgbGluayA9IHRhcmdldC5jbG9zZXN0KCcuZ2FsbGVyeV9fbGluaycpO1xuXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBpZiAoIWxpbmspIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGluZm8gPSBKU09OLnBhcnNlKGxpbmsuZ2V0QXR0cmlidXRlKCdkYXRhLWluZm8nKSk7XG5cbiAgICAgICAgICAgIHNlbGYubW9kYWxPcGVuKGluZm8pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0IG1vZHVsZVxuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5pbml0ID0gKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5nZXRPcHRpb25zKCk7XG4gICAgICAgICAgICBzZWxmLnNldHVwTGlzdGVuZXIoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgd2luZG93LmFwcC5tb2R1bGVzLmdhbGxlcnkgPSBuZXcgR2FsbGVyeSgpO1xufSkoKTtcbiIsIigoKSA9PiB7XG4gICAgaWYgKCF3aW5kb3cuYXBwKSB7XG4gICAgICAgIHdpbmRvdy5hcHAgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAoISgnbW9kdWxlcycgaW4gd2luZG93LmFwcCkpIHtcbiAgICAgICAgd2luZG93LmFwcC5tb2R1bGVzID0ge307XG4gICAgfVxuXG4gICAgaWYgKCdtYWluJyBpbiBhcHAubW9kdWxlcykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBNYWluIGNsYXNzLlxuICAgICAqIEBjbGFzc1xuICAgICAqL1xuICAgIGNvbnN0IE1haW4gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBvcHRpb25zIGZvciBtb2R1bGVcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuZ2V0T3B0aW9ucyA9ICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuaHRtbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2h0bWwnKTtcbiAgICAgICAgICAgIHNlbGYuYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcbiAgICAgICAgICAgIHNlbGYubW9kdWxlcyA9IGFwcC5tb2R1bGVzO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJbml0IGFsbCBtb2R1bGVzIGluIGFwcC5tb2R1bGVzXG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLmluaXRNb2R1bGVzID0gKCkgPT4ge1xuICAgICAgICAgICAgZm9yIChsZXQgbW9kdWxlIGluIHNlbGYubW9kdWxlcykge1xuXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYubW9kdWxlcy5oYXNPd25Qcm9wZXJ0eShtb2R1bGUpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLm1vZHVsZXNbbW9kdWxlXS5pbml0ICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUgIT09ICdtYWluJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm1vZHVsZXNbbW9kdWxlXS5pbml0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXQgbW9kdWxlXG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLmluaXQgPSAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLmdldE9wdGlvbnMoKTtcbiAgICAgICAgICAgIHNlbGYuaW5pdE1vZHVsZXMoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgd2luZG93LmFwcC5tb2R1bGVzLm1haW4gPSBuZXcgTWFpbigpO1xufSkoKTtcbiIsIigoKSA9PiB7XG4gICAgaWYgKCF3aW5kb3cuYXBwKSB7XG4gICAgICAgIHdpbmRvdy5hcHAgPSB7fTtcbiAgICB9XG5cbiAgICBpZiAoISgnbW9kdWxlcycgaW4gd2luZG93LmFwcCkpIHtcbiAgICAgICAgd2luZG93LmFwcC5tb2R1bGVzID0ge307XG4gICAgfVxuXG4gICAgaWYgKCdtb2RhbCcgaW4gYXBwLm1vZHVsZXMpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgTW9kYWwgY2xhc3MuXG4gICAgICogQGNsYXNzXG4gICAgICovXG4gICAgY29uc3QgTW9kYWwgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEdldCBvcHRpb25zIGZvciBtb2R1bGVcbiAgICAgICAgICovXG4gICAgICAgIHNlbGYuZ2V0T3B0aW9ucyA9ICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsJyk7XG4gICAgICAgICAgICBzZWxmLnRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX190aXRsZScpO1xuICAgICAgICAgICAgc2VsZi5kZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fZGVzY3JpcHRpb24gcCcpO1xuICAgICAgICAgICAgc2VsZi5pbWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3ByZXZpZXcgaW1nJyk7XG4gICAgICAgICAgICBzZWxmLmNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgZXZlbnRzIGxpc3RlbmVyc1xuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5zZXR1cExpc3RlbmVyID0gKCkgPT4ge1xuICAgICAgICAgICAgc2VsZi5jbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNlbGYuY2xvc2UpO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBPcGVuIG1vZGFsIHdpbmRvd1xuICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gaW5mb1xuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5vcGVuID0gKGluZm8pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBpbmZvIHx8IHt9O1xuXG4gICAgICAgICAgICBkYXRhLnRpdGxlID0gZGF0YS50aXRsZSA/IGRhdGEudGl0bGUgOiAn0JfQsNCz0L7Qu9C+0LLQvtC6INC40LfQvtCx0YDQsNC20LXQvdC40Y8g0L3QtSDQvdCw0LnQtNC10L0nO1xuICAgICAgICAgICAgZGF0YS5kZXNjcmlwdGlvbiA9IGRhdGEuZGVzY3JpcHRpb24gPyBkYXRhLmRlc2NyaXB0aW9uIDogJ9Ce0L/QuNGB0LDQvdC40LUg0LjQt9C+0LHRgNCw0LbQtdC90LjRjyDQvdC1INC90LDQudC00LXQvdC+Lic7XG4gICAgICAgICAgICBkYXRhLnNvdXJjZSA9IGRhdGEuc291cmNlID8gZGF0YS5zb3VyY2UgOiAnaW1hZ2VzL3Zpcy1lcnJvci5qcGcnO1xuXG4gICAgICAgICAgICBzZWxmLnRpdGxlLnRleHRDb250ZW50ID0gZGF0YS50aXRsZTtcbiAgICAgICAgICAgIHNlbGYuZGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgc2VsZi5pbWcuc3JjID0gZGF0YS5zb3VyY2U7XG5cbiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ21vZGFsX3N0YXRlX29wZW4nKTtcbiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ21vZGFsX3N0YXRlX2xvYWRpbmcnKTtcblxuICAgICAgICAgICAgc2VsZi5pbWcuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHNlbGYubG9hZCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIENsb3NlIG1vZGFsIHdpbmRvd1xuICAgICAgICAgKi9cbiAgICAgICAgc2VsZi5jbG9zZSA9ICgpID0+IHtcbiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX3N0YXRlX29wZW4nKTtcbiAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ21vZGFsX3N0YXRlX2xvYWRpbmcnKTtcblxuICAgICAgICAgICAgc2VsZi5pbWcucmVtb3ZlRXZlbnRMaXN0ZW5lcignbG9hZCcsIHNlbGYubG9hZCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIFJlbW92ZSBsb2FkaW5nIHN0YXRlXG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLmxvYWQgPSAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLmNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKCdtb2RhbF9zdGF0ZV9sb2FkaW5nJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXQgbW9kdWxlXG4gICAgICAgICAqL1xuICAgICAgICBzZWxmLmluaXQgPSAoKSA9PiB7XG4gICAgICAgICAgICBzZWxmLmdldE9wdGlvbnMoKTtcbiAgICAgICAgICAgIHNlbGYuc2V0dXBMaXN0ZW5lcigpO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICB3aW5kb3cuYXBwLm1vZHVsZXMubW9kYWwgPSBuZXcgTW9kYWwoKTtcbn0pKCk7XG4iXX0=
